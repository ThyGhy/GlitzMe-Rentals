{% extends "admin/base.html" %}

{% block title %}Site Settings - GlitzME Admin{% endblock %}

{% block content %}
<div class="content-header">
    <h1 class="page-title">
        <i class="fas fa-cogs"></i> Site Settings
    </h1>
    <a href="{{ url_for('index') }}" target="_blank" class="btn btn-secondary">
        <i class="fas fa-external-link-alt"></i> View Site
    </a>
 </div>

<form method="POST">
  <div style="display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 2rem; align-items: start;">
    <!-- Left: Editable settings -->
    <div class="content-card">
      <h3><i class="fas fa-sliders-h"></i> Business & Branding</h3>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
        <div class="form-group">
          <label for="business_name" class="form-label"><i class="fas fa-building"></i> Business name</label>
          <input type="text" class="form-input" id="business_name" name="business_name" value="{{ settings.get('business_name', '') }}" placeholder="e.g., GlitzME Rentals">
        </div>
        <div class="form-group">
          <label for="tagline" class="form-label"><i class="fas fa-sparkles"></i> Tagline</label>
          <input type="text" class="form-input" id="tagline" name="tagline" value="{{ settings.get('tagline', '') }}" placeholder="Family Owned & Operated">
        </div>
      </div>
      <div class="form-group">
        <label for="business_description" class="form-label"><i class="fas fa-paragraph"></i> Short description</label>
        <textarea class="form-textarea" id="business_description" name="business_description" rows="3" placeholder="Brief description shown in footer and SEO">{{ settings.get('business_description', '') }}</textarea>
      </div>
      <div class="form-group">
        <label for="team_section_quote" class="form-label"><i class="fas fa-quote-left"></i> Team section quote</label>
        <input type="text" class="form-input" id="team_section_quote" name="team_section_quote" value="{{ settings.get('team_section_quote', '') }}" placeholder='"None of us is as smart as all of us." - Ken Blanchard'>
      </div>

      <hr style="border-color: rgba(255,255,255,0.1); margin: 1.5rem 0;">
      <h3><i class="fas fa-address-card"></i> Contact & Social</h3>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div class="form-group">
          <label for="phone_primary" class="form-label"><i class="fas fa-phone"></i> Primary phone</label>
          <input type="tel" class="form-input" id="phone_primary" name="phone_primary" value="{{ settings.get('phone_primary', '') }}" placeholder="(702) 344-4717">
        </div>
        <div class="form-group">
          <label for="phone_secondary" class="form-label"><i class="fas fa-phone"></i> Secondary phone (optional)</label>
          <input type="tel" class="form-input" id="phone_secondary" name="phone_secondary" value="{{ settings.get('phone_secondary', '') }}" placeholder="(702) 622-0425">
        </div>
        <div class="form-group">
          <label for="email" class="form-label"><i class="fas fa-envelope"></i> Email</label>
          <input type="email" class="form-input" id="email" name="email" value="{{ settings.get('email', '') }}" placeholder="business@glitzmerentals.com">
        </div>
        <div class="form-group">
          <label for="address" class="form-label"><i class="fas fa-map-marker-alt"></i> City & State</label>
          <input type="text" class="form-input" id="address" name="address" value="{{ settings.get('address', '') }}" placeholder="Las Vegas, NV">
        </div>
        <div class="form-group" style="grid-column: 1 / -1;">
          <label for="instagram_url" class="form-label"><i class="fab fa-instagram"></i> Instagram URL</label>
          <input type="url" class="form-input" id="instagram_url" name="instagram_url" value="{{ settings.get('instagram_url', '') }}" placeholder="https://www.instagram.com/glitzme_rentals/">
        </div>
      </div>

      <hr style="border-color: rgba(255,255,255,0.1); margin: 1.5rem 0;">
      <h3><i class="fas fa-search"></i> SEO & Meta</h3>
      <div class="form-group">
        <label for="meta_description" class="form-label"><i class="fas fa-align-left"></i> Meta description</label>
        <textarea class="form-textarea" id="meta_description" name="meta_description" rows="3" placeholder="150-160 characters for Google">{{ settings.get('meta_description', '') }}</textarea>
      </div>
      <div class="form-group">
        <label for="meta_keywords" class="form-label"><i class="fas fa-key"></i> Meta keywords</label>
        <textarea class="form-textarea" id="meta_keywords" name="meta_keywords" rows="2" placeholder="comma, separated, keywords">{{ settings.get('meta_keywords', '') }}</textarea>
      </div>

      <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1rem;">
        <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Back</a>
        <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Save Settings</button>
      </div>
    </div>

    <!-- Right: Live Preview -->
    <div class="content-card" style="position: sticky; top: 2rem;">
      <h3><i class="fas fa-eye"></i> Live Preview</h3>
      <div style="margin-top: 1rem; display: grid; gap: 1rem;">
        <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 10px;">
          <h4 id="preview-business-name">{{ settings.get('business_name', 'Your Business Name') }}</h4>
          <p id="preview-tagline" style="opacity: 0.8;">{{ settings.get('tagline', 'Tagline will appear here') }}</p>
          <p id="preview-description" style="opacity: 0.8; font-size: 0.95rem;">{{ settings.get('business_description', 'Short description of your business...') }}</p>
        </div>
        <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 10px;">
          <h5 style="margin-bottom: .5rem;">Contact</h5>
          <p style="margin: 0;">📞 <span id="preview-phone">{{ settings.get('phone_primary', '(702) 344-4717') }}</span></p>
          {% if settings.get('phone_secondary') %}
          <p style="margin: 0;">📞 <span id="preview-phone2">{{ settings.get('phone_secondary') }}</span></p>
          {% else %}
          <p style="margin: 0; display:none;" id="preview-phone2-wrap">📞 <span id="preview-phone2"></span></p>
          {% endif %}
          <p style="margin: 0;">✉️ <span id="preview-email">{{ settings.get('email', 'Glitzme.rentals21@gmail.com') }}</span></p>
          <p style="margin: 0;">📍 <span id="preview-address">{{ settings.get('address', 'Las Vegas, NV') }}</span></p>
        </div>
        <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 10px;">
          <h5 style="margin-bottom: .5rem;">Team Section</h5>
          <blockquote id="preview-quote" style="margin: 0; opacity: 0.9;">{{ settings.get('team_section_quote', '"None of us is as smart as all of us." - Ken Blanchard') }}</blockquote>
        </div>
      </div>
    </div>
  </div>
</form>

<script>
// Live preview bindings
const bind = (id, cb) => {
  const el = document.getElementById(id);
  if (!el) return;
  el.addEventListener('input', () => cb(el.value));
};

bind('business_name', v => document.getElementById('preview-business-name').textContent = v || 'Your Business Name');
bind('tagline', v => document.getElementById('preview-tagline').textContent = v || 'Tagline will appear here');
bind('business_description', v => document.getElementById('preview-description').textContent = v || 'Short description of your business...');
bind('team_section_quote', v => document.getElementById('preview-quote').textContent = v || '"None of us is as smart as all of us." - Ken Blanchard');
bind('phone_primary', v => document.getElementById('preview-phone').textContent = v || '(702) 344-4717');
bind('phone_secondary', v => {
  const wrap = document.getElementById('preview-phone2-wrap');
  const node = document.getElementById('preview-phone2');
  if (v) { if (wrap) wrap.style.display = ''; node.textContent = v; } else { if (wrap) wrap.style.display = 'none'; node.textContent = ''; }
});
bind('email', v => document.getElementById('preview-email').textContent = v || 'Glitzme.rentals21@gmail.com');
bind('address', v => document.getElementById('preview-address').textContent = v || 'Las Vegas, NV');
</script>
{% endblock %}